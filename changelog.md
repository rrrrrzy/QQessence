# Changelog

## 2025.12.19 23:55

### 新增功能
- **自动创建img文件夹**: 程序启动时自动检查并创建img文件夹,无需手动创建
- **文件包装类型支持**: 新增对群文件(file_wrap)类型精华消息的解析支持
- **主程序入口守卫**: 添加 `if __name__ == "__main__":` 确保模块导入时不会自动执行下载

### 功能改进
- **异常处理增强**: 为QQ账号、昵称、时间、图片等解析添加try-except,防止单条消息解析失败导致程序崩溃
- **下载功能优化**:
  - 使用Session复用连接,提高下载效率
  - 添加超时机制(10秒)和状态码检查
  - 根据HTTP响应头Content-Type智能判断文件类型(jpg/png/gif等)
  - 支持下载过程中的实时进度显示
  - 添加下载列表去重功能
- **线程管理改进**: 线程创建前检查任务列表是否为空,添加线程join等待机制
- **统计信息输出**: 显示解析的精华消息数量、发现的文件链接数量、去重后的下载任务数量

### 代码质量提升
- 改进错误提示信息的友好性
- 优化代码结构和注释
- 使用with语句管理文件操作,确保资源正确释放

---

## e68b7d2 版本
- 基础的QQ群精华消息爬取功能
- 支持短文本、图文、纯图片、图片包装、文档包装等类型
- 基础的多线程下载功能
- 输出txt格式结果文件